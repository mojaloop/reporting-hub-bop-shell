version: "3.7"

networks:
  mojaloop-net:
    name: mojaloop-net

services:
  reporting-hub-bop-shell:
    container_name: reporting-hub-bop-shell
    image: mojaloop/reporting-hub-bop-shell
    build:
      context: .
      cache_from:
        - mojaloop/reporting-hub-bop-shell
    environment:
      # - AUTH_API_BASE_URL=/api
      - AUTH_MOCK_API=false
      - REMOTE_API_BASE_URL=/remote
      - REMOTE_MOCK_API=true
      - LOGIN_URL=http://127.0.0.1:4433/self-service/login/browser
      - LOGOUT_URL=http://127.0.0.1:4433/self-service/logout
      - AUTH_ENABLED=true
      - AUTH_TOKEN_ENDPOINT=http://127.0.0.1:4433/sessions/whoami
      - REMOTE_1_URL=http://localhost:8081
      - REMOTE_2_URL=http://localhost:8082
    ports:
      - "8080:8080"
    networks:
      - mojaloop-net
    healthcheck:
      test: wget -q http://172.17.0.1:8080 -O /dev/null || exit 1
      timeout: 20s
      retries: 30
      interval: 15s
